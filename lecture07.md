# 第７回課題 #
## 考えうる攻撃 ##
- DDos攻撃
  - Dos攻撃・・標的のサーバーに大量のパケットを送り付けてサービス拒否にさせる攻撃
  - DDos攻撃・・複数のコンピューターからDos攻撃を行うこと　分散型サービス拒否攻撃
  - 第３，４層への攻撃・・インフラへの攻撃　サーバーやネットワークの負荷を増大させる
  - 第６，７層への攻撃・・アプリ側への攻撃　システム運用によってより致命的となる

- UDP reflection attacks
  - 送信元IPを偽ってDNS問い合わせを行うことで、DNSサーバが攻撃対象に応答パケットを送る攻撃
  - DNSは問い合わせよりも応答のパケットが大きいため、小さなクエリを増幅して攻撃パケットを生成できる  
    *DNSアンプ攻撃

- SYN floods
  - - TCPの３WAYハンドシェイクの第一段階であるSYNパケットを送信元IPを偽って連続して送信する攻撃
  - サーバーがSYNーACKパケットを返してもACKパケットを受け取れないため
    タイムアウトするまでリソースを消費することになる

- HTTP floods
  - 多数の端末やサーバーにインストールしたBotを使い、攻撃対象のサーバーに大量のHTTPリクエストを送信する攻撃

- 蓄積型XSS
  - DBに悪意あるスクリプトを書き込まれる方式
  - アプリを通常通り使うだけで攻撃コードが実行される

- SQLインジェクション
  - セキュリティの脆弱性をついてDBを不正に操作する攻撃
  - DBからデータを取得する、データを改ざん・破壊するためにSQL文を注入する

## 攻撃に対応するAWSサービス ##
- AWS Shild
  - DDos攻撃を防ぐ
  - スタンダードは自動的に無料で利用できる
  - 料金：１年で3000USD

- AWS WAF
  - 特定の条件に合致する通信をアプリケーションレベルで検知・遮断する
  - rate-based limit　ルールを設定できる
  - 過剰なリクエストを送信しているIPからのリクエストを一時的にブロックできる
　　　　5分間で100リクエスト～設定できる
  - SQLインジェクションをブロックするルールのテンプレも用意されている
  - 料金：1マネージドルールは月額5～30USD

- AWS ACM
  - SSL 証明書を発行するマネージドサービス
  - ロードバランサーにアタッチする
  - ALB ならリスナールールで「HTTP」アクセスを「HTTPS」に転送するルールを追加する
  - 料金：パブリック SSL/TLS 証明書は無料

- Amazon GuardDuty
  - AWS内のイベントログを分析することで  
    セキュリティインシデントの疑いがあるイベントについて指摘してくれる  
  - 料金：分析対象によって異なる　＊以下の組み合わせ  
　- AWS CloudTrail 管理イベント分析：100 万イベントあたり $4.72  
　- AWS CloudTrail S3 データイベント分析：100 万イベントあたり 1.04USD  
　- Amazon EKS 監査ログ：2.48USD/100 万件のイベント  
　- VPC フローログと DNS クエリログの分析：GB あたり 1.18USD  
　- EBS データボリュームのスキャン分析：1 GB あたり 0.05USD

- Amazon Inspector
  - EC2インスタンスへのネットワークアクセスとその上のアプリケーションに対して脆弱性診断を自動で行ってくれる
  - 料金：「実行対象」 × 「実行回数」 × 「利用料」で課金  
    どの評価ルールを使用するかによって「利用料」が異なる  
    - ネットワークの到達可能性ルール 最初の 250 回のインスタンス評価 1回あたり0.13USD
    - ホスト評価のルール　最初の 250 回のインスタンス評価 1回あたり0.30USD
    

- Amazon Security Hub
  - セキュリティのベストプラクティスのチェックを行い、アラートを集約し、自動修復を可能にするクラウドセキュリティ体制管理サービス
  - 認証情報を検索して、脆弱な部分を指摘してくれる
  - 料金：以下 2種類の料金体系の合算
    - 1アカウント当たり最初の100,000件分のコンプライアンスチェックが0.0010USD/件
    - 1アカウント当たり最初の10,000件のイベント取り込みについては無料
  
- AWS Secrets Manager
  - データベース認証情報、API キー、その他のシークレットを
  　ライフサイクルを通して管理、取得、ローテーションできるようにする
  - 料金：シークレットあたり 0.40USD/月 レプリカごとに 1 か月あたり 0.40USD

## アプリ側の対策 ##
- XSS対策
  - ウェブページに出力する全ての要素に対して、エスケープ処理を施す
  - <script>...</script> 要素の内容を動的に生成しない
  - スタイルシートを任意のサイトから取り込めるようにしない
  - 仕様に合わない値を入力された場合は処理を先に進めず、再入力を求めるようにする
  - 入力される文字の種類や文字数で制限をかけるバリデーションを行う
  - HTTPレスポンスヘッダのContent-Typeフィールドに文字コード（charset）を指定する
  - ブラウザの「XSS フィルタ」の設定を有効にする
  - Cookie情報の漏えい対策として、発行するCookieにHttpOnly属性を加え、TRACEメソッドを無効化する


